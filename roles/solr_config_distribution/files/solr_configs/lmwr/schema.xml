<?xml version="1.0" encoding="UTF-8"?>

<schema name="lmwr" version="1.6">

    <!-- ***********************
     Field type definitions
    ************************ -->

    <!-- boolean field types: "true" or "false" -->
    <fieldType name="boolean" class="solr.BoolField" docValues="true" sortMissingLast="true"/>
    <fieldType name="booleans" class="solr.BoolField" docValues="true" sortMissingLast="true" multiValued="true"/>

    <!-- numeric field types -->
    <fieldType name="int" class="solr.IntPointField" docValues="true"/>
    <fieldType name="ints" class="solr.IntPointField" docValues="true" multiValued="true"/>
    <fieldType name="float" class="solr.FloatPointField" docValues="true"/>
    <fieldType name="floats" class="solr.FloatPointField" docValues="true" multiValued="true"/>
    <fieldType name="long" class="solr.LongPointField" docValues="true"/>
    <fieldType name="longs" class="solr.LongPointField" docValues="true" multiValued="true"/>
    <fieldType name="double" class="solr.DoublePointField" docValues="true"/>
    <fieldType name="doubles" class="solr.DoublePointField" docValues="true" multiValued="true"/>


    <!-- date field types -->
    <fieldType name="date" class="solr.DatePointField" docValues="true"/>
    <fieldType name="dates" class="solr.DatePointField" docValues="true" multiValued="true"/>
    <fieldType name="date_range" class="solr.DateRangeField" />

    <!-- string field types -->
    <fieldType name="string" class="solr.StrField" sortMissingLast="true" docValues="true"/>
    <fieldType name="strings" class="solr.StrField" sortMissingLast="true" docValues="true" multiValued="true"/>

    <!-- text field types -->
    <fieldType name="text" class="solr.TextField" positionIncrementGap="100"/>
    <fieldType name="texts" class="solr.TextField" positionIncrementGap="100" multiValued="true"/>

    <!-- search field type -->
    <fieldType name="search_text_general" class="solr.TextField" positionIncrementGap="100" multiValued="true">
        <analyzer type="index">
            <tokenizer class="solr.StandardTokenizerFactory"/>
            <filter class="solr.LowerCaseFilterFactory"/>
        </analyzer>
        <analyzer type="query">
            <tokenizer class="solr.StandardTokenizerFactory"/>
            <filter class="solr.LowerCaseFilterFactory"/>
            <filter class="solr.EdgeNGramFilterFactory" minGramSize="3" maxGramSize="25"/>
        </analyzer>
    </fieldType>

    <fieldType name="search_text_ngram" class="solr.TextField" positionIncrementGap="100" multiValued="true">
        <analyzer type="index">
            <tokenizer class="solr.StandardTokenizerFactory"/>
            <filter class="solr.LowerCaseFilterFactory"/>
            <filter class="solr.NGramFilterFactory" minGramSize="2" maxGramSize="13"/>
        </analyzer>
        <analyzer type="query">
            <tokenizer class="solr.StandardTokenizerFactory"/>
            <filter class="solr.LowerCaseFilterFactory"/>
        </analyzer>
    </fieldType>

    <!-- special field types -->
    <fieldType name="_nest_path_" class="solr.NestPathField" maxCharsForDocValues="-1" omitNorms="true" omitTermFreqAndPositions="true" stored="false"/>


    <!-- ***********************
     Document field definitions
    ************************ -->

    <!-- fields automatically set by solr -->
    <field name="_version_" type="long" indexed="false" stored="false"/>
    <field name="_root_" type="string" docValues="false" indexed="true" stored="true"/>
    <field name="_nest_path_" type="_nest_path_"/>
    <field name="_nest_parent_" type="string" indexed="true" stored="true"/>

    <!-- mandatory fields -->
    <field name="_index_id_" type="string" multiValued="false" required="true" indexed="true" stored="true"/>
    <field name="_available_as_result_" type="boolean" indexed="false" stored="true" />
    <field name="type" type="string" required="true" indexed="false" stored="true"/>

    <!-- stored fields
      input and result document fields
    -->
    <!-- common -->
    <field name="dbId" type="long" indexed="false" stored="true" />
    <field name="path" type="string" indexed="false" stored="true" />
    <field name="language" type="string" indexed="false" stored="true" />
    <field name="description" type="text" indexed="false" stored="true" />
    <field name="logoUrl" type="string" indexed="false" stored="true" />
    <field name="name" type="string" indexed="false" stored="true" />
    <field name="tagList" type="strings" indexed="false" stored="true" />

    <!-- FirstSpirit -->
    <field name="headline" type="text" indexed="false" stored="true" />
    <field name="metaHeadline" type="text" indexed="false" stored="true" />
    <field name="teaserImage" type="string" indexed="false" stored="true" />
    <field name="teaserText" type="string" indexed="false" stored="true" />
    <field name="content" type="texts" indexed="false" stored="true" />
    <field name="publishDate" type="date_range" indexed="true" stored="true" />

    <!-- Exhibitor -->
    <field name="nfmFairId" type="long" indexed="false" stored="true" />
    <field name="nfmExhibitorId" type="long" indexed="false" stored="true" />
    <field name="companyProfile" type="string" indexed="false" stored="true" />

    <!-- Address -->
    <field name="sortName" type="string" indexed="false" stored="true" />
    <field name="streetWithNr" type="string" indexed="false" stored="true" />
    <field name="zipCode" type="string" indexed="false" stored="true" />
    <field name="city" type="string" indexed="false" stored="true" />
    <field name="country" type="string" indexed="false" stored="true" />

    <!-- Booth -->
    <field name="hall" type="string" indexed="false" stored="true" />
    <field name="booth" type="string" indexed="false" stored="true" />
    <field name="gangway" type="string" indexed="false" stored="true" />

    <!-- Marker -->
    <field name="iconPath" type="string" indexed="false" stored="true" />

    <!-- Fair -->
    <field name="subtitle" type="string" indexed="false" stored="true" />
    <field name="linkUrl"  type="string" indexed="false" stored="true" />
    <field name="linkText" type="string" indexed="false" stored="true" />
    <field name="linkTarget" type="string" indexed="false" stored="true" />
    <field name="location" type="string" indexed="false" stored="true" />
    <field name="startDate" type="date" indexed="false" stored="true" />
    <field name="endDate" type="date" indexed="false" stored="true" />
    <field name="period" type="date_range" indexed="true" stored="false" />
    <field name="displayExactDate" type="boolean" indexed="false" stored="true" />
    <field name="keywords" type="string" indexed="false" stored="true" />
    <field name="sectorList" type="strings" indexed="false" stored="true" />
    <field name="shopLinkUrl" type="string" indexed="false" stored="true" />
    <field name="shopLinkText" type="string" indexed="false" stored="true" />
    <field name="shopLinkTarget" type="string" indexed="false" stored="true" />
    <field name="exhibitorRegistrationLinkUrl" type="string" indexed="false" stored="true" />
    <field name="exhibitorRegistrationLinkText" type="string" indexed="false" stored="true" />
    <field name="exhibitorRegistrationLinkTarget" type="string" indexed="false" stored="true" />

    <!-- index fields
      generally copied and aggregated from stored fields
    -->
    <field name="catchall_score_high" type="search_text_general" indexed="true" stored="false" />
    <field name="catchall_score_middle" type="search_text_general" indexed="true" stored="false" />
    <field name="catchall" type="search_text_general" indexed="true" stored="false" />
    <field name="ngrams" type="search_text_ngram" indexed="true" stored="false" />

    <!-- copy fields
      generally copied and aggregated from stored fields
    -->
    <copyField source="headline" dest="catchall_score_high" />
    <copyField source="headline" dest="ngrams" />
    <copyField source="content" dest="catchall" />

    <copyField source="name" dest="catchall_score_high" />
    <copyField source="name" dest="ngrams" />
    <copyField source="companyProfile" dest="catchall" />

    <copyField source="subtitle" dest="catchall_score_middle" />
    <copyField source="subtitle" dest="ngrams" />
    <copyField source="keywords" dest="catchall_score_middle" />
    <copyField source="tagList" dest="catchall_score_middle" />
    <copyField source="location" dest="catchall" />


    <!-- Field to use to determine and enforce document uniqueness.
      Unless this field is marked with required="false", it will be a required field
    -->
    <uniqueKey>_index_id_</uniqueKey>

</schema>
